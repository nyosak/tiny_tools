# GAS ã§ Google groups ã®æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼ã« Promo code ã‚’è‡ªå‹•é€ä¿¡ã™ã‚‹

æœ‰æ–™ã‚¢ãƒ—ãƒªã®ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ†ã‚¹ãƒˆè¦å“¡å‹Ÿé›†ã®ãŸã‚

---

# ğŸŒ’ï¸ åº

å€‹äººé–‹ç™ºè€…ãŒ Google Play Store ã« Android ã‚¢ãƒ—ãƒªã‚’è¼‰ã›ã¦ã‚‚ã‚‰ã†ã«ã¯ã€ 12äººã®ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ã‚¿ãƒ¼ã‚’å‹Ÿé›†ã—é€£ç¶š14æ—¥ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ã¦ã‚‚ã‚‰ã‚ãªã„ã¨ã„ã‘ãªã„ã€‚é€£ç¶š14æ—¥ãªã©ã¨ã„ã†æ™‚ç‚¹ã§ã€æ—¢ã«é•æ³•åŠ´åƒã«ãªã‚‹ã®ã§ã€ã“ã“ã¯ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ã«ãŠé¡˜ã„ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚

æœ‰æ–™ã‚¢ãƒ—ãƒªã ã¨ã€ãƒ†ã‚¹ã‚¿ãƒ¼ã«ã‚¢ãƒ—ãƒªã‚’è³¼å…¥ã—ã¦ã‚‚ã‚‰ã‚ãªã„ã¨ãƒ†ã‚¹ãƒˆã§ããšã€ã»ã¼ç„¡ç†ã‚²ãƒ¼ã«è¦‹ãˆã‚‹ã®ã ãŒã€ Promo code ç™ºè¡Œã§ç„¡æ–™ã«ã™ã‚‹ã¨ã„ã†è£æŠ€ãŒã‚ã‚‹ã€‚ãŸã ã—ã€ãƒ†ã‚¹ã‚¿ãƒ¼å…¨å“¡ã«å€‹åˆ¥ã« Promo code ã‚’é…å¸ƒã™ã‚‹ã¨ã„ã†æ‰‹é–“ãŒã‹ã‹ã‚‹ã€‚ãã®æ‰‹é–“ã‚’æƒœã—ã‚€ï¼ˆã¨ã„ã†ã‚ˆã‚Šã¯ã€24æ™‚é–“å—ä»˜å¯èƒ½ã«ã™ã‚‹ï¼‰ãŸã‚ã«ã€è‡ªå‹•é€ä¿¡ã®ä»•çµ„ã¿ã‚’ä½œã£ãŸã€‚

# ğŸŒ•ï¸ ç ´

## ãƒ†ã‚¹ã‚¿ãƒ¼å‹Ÿé›†

12äººã¨çŸ¥ã£ãŸæ™‚ç‚¹ã§çµ‚ã‚ã£ãŸæ„ŸãŒã‚ã£ãŸã®ã ãŒã€èª¿ã¹ã¦ã¿ã‚‹ã¨ãƒ†ã‚¹ã‚¿ãƒ¼å‹Ÿé›†ã—ãŸã„äººãŒç›¸äº’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‚ˆã†ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãŒã§ãã‚ãŒã£ã¦ã„ã¦ã€ãã¡ã‚‰ã«åŠ©ã‘ã¦ã‚‚ã‚‰ã†ã“ã¨ã«ã—ãŸã€‚

- [Androidã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ†ã‚¹ãƒˆã‚’æœ€é€Ÿã§ä¹—ã‚Šè¶Šãˆã‚‹æ–¹æ³•](https://zenn.dev/android_tester/articles/f12a1e313fd216)
- [Androidã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ†ã‚¹ãƒˆã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®ã”æ”¯æ´ã®ãŠé¡˜ã„](https://note.com/yusuke1225math2/n/n5eb506280c20)

ã“ã¡ã‚‰ã®èª¬æ˜ã©ãŠã‚Šã€ Google Groups ã‚’ä½¿ã£ã¦å‚åŠ ãƒ†ã‚¹ã‚¿ãƒ¼ã‚’ç®¡ç†ã™ã‚‹æ–¹æ³•ã‚’æ¡ã£ãŸã€‚

## Promo code

- [ã‚®ãƒ•ãƒˆã‚«ãƒ¼ãƒ‰ã¾ãŸã¯ã‚®ãƒ•ãƒˆã‚³ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ - Google Play ãƒ˜ãƒ«ãƒ—](https://support.google.com/googleplay/answer/3422659?hl=ja)

ä¸Šè¨˜ã®èª¬æ˜ã©ãŠã‚Šã«ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã€ã‚¢ãƒ—ãƒªã®è³¼å…¥ã‚’ 100%å‰²å¼•ã§ç„¡æ–™ã«ã™ã‚‹ã€‚

![redeem_promo_code.png](https://nyosak.github.io/article-base-doc/media/70603_promo_code_sender_redeem_promo_code.png)

ã“ã®ã‚³ãƒ¼ãƒ‰ãŒå˜ä¸€ã§ã¯ãªãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ç•°ãªã‚‹ã®ã§ã€é…å¸ƒãŒæ‰‹é–“ã«ãªã‚‹ã€‚ Promo code ã‚’ç™ºè¡Œã™ã‚‹ã¨ã€äººæ•°åˆ†ã®ã‚³ãƒ¼ãƒ‰ãŒè¡Œã”ã¨ã«ãªã‚‰ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚ã“ã‚Œã‚’ Google Sheets ã® Aåˆ—ã«ä¸¦ã¹ã¦ãŠãã€ãã“ã‹ã‚‰è‡ªå‹•é€ä¿¡ã™ã‚‹ä»•çµ„ã¿ã‚’è€ƒãˆã¦ã¿ãŸã€‚

## ç›®è«–è¦‹

### ã‚„ã‚ŠãŸã„ã“ã¨

```mermaid
%%{init:
	{
		"theme": "forest",
		"logLevel": 2
	}
}%%

sequenceDiagram

rect rgb(238, 233, 221)

Actor tester
participant group
participant sheet
participant gas
Actor admin

tester-)group: å‚åŠ ç™»éŒ²

gas->>+group: 15åˆ†æ¯ã«å–å¾—
group-->>-gas: ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§

gas->>+sheet: ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ã‚’åæ˜ 
sheet-->>-gas: æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼ã¨ Promo code

gas-)tester: Promo code ã‚’ãƒ¡ãƒ¼ãƒ«
gas-)admin: æˆåŠŸ
gas-)admin: Error: Promo code åˆ‡ã‚Œ

end

```

### ã‹ã‚‰ãã‚Š

```mermaid
%%{init:
	{
		"theme": "forest",
		"logLevel": 2,
		"flowchart": { "curve": "linear" }
	}
}%%

flowchart TB

group["Google Groups"]
mail(("send Email"))

subgraph sheet["Google Sheets"]
  codes
  emails
end

subgraph "Google Apps Script"

  subgraph "GAS library"
    PromoCodeSender
  end

  subgraph sheet_app["linked with Sheets"]
    Executor
  end

  trigger((Trigger))
  users[(current users)]
end

trigger -- "run every 15 minute" --> Executor
Executor --> PromoCodeSender
PromoCodeSender -- "get member list" --> group
group --> users
users -- update --> emails
users -- "update column B" --> codes
codes -- "email, promo code, error" --> PromoCodeSender
PromoCodeSender --> mail

sheet ---- sheet_app

linkStyle default color:#936, stroke:#f69, stroke-width:2px;
classDef default fill:#fcc, stroke:#345, stroke-width:3px, font-size:14pt;

```

## GAS

Google Apps Script (GAS) ã‚’ä½¿ã†ã¨æ‰‹è»½ã«ç„¡æ–™ã§ã‚¯ãƒ©ã‚¦ãƒ‰ã£ã½ã„ã“ã¨ãŒã§ãã‚‹ã€‚

- [Apps Script](https://script.google.com/home)

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Šã€ JavaScript ã£ã½ã„ã‚³ãƒ¼ãƒ‰ï¼ˆãƒ•ãƒ«ã‚»ãƒƒãƒˆã§ã¯ãªã„ï¼‰ã‚’æ›¸ã‘ã°ã€ä¸€å®šã®åˆ¶é™æ ã®ä¸­ã¨ã¯ã„ãˆã€GCP ã§å‹•ã‹ã›ã‚‹ã€‚ Google ã®ã‚¢ãƒ—ãƒªã‚„ã‚µãƒ¼ãƒ“ã‚¹ã«é€£æºã—ãŸ API ãŒä½¿ãˆã‚‹ã®ã§ã€ä»Šå›ã®ã‚·ã‚¹ãƒ†ãƒ ã§å¿…è¦ãªã‚‚ã®ãŒã™ã¹ã¦æƒã†ã€‚

- [Gmail](https://developers.google.com/apps-script/reference/gmail/gmail-app)
- [Group](https://developers.google.com/apps-script/reference/groups/group)
- [Sheet](https://developers.google.com/apps-script/reference/spreadsheet/range)
- [running account](https://developers.google.com/apps-script/reference/base/user.html)

ä»Šå›ã¯ã€ Sheet ä¸Šã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ Promo code ã‚’ç®¡ç†ã™ã‚‹ã®ã§ã€ Sheet ã«é€£æºã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œã‚‹ã€‚

1. My Drive ã§æ–°ã—ã„ Sheet ã‚’ä½œæˆã™ã‚‹
1. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ Extensions -> Apps Script ã¨æ“ä½œã™ã‚‹ã¨ã€é€£æºã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒæ–°ã—ãä½œã‚‰ã‚Œã‚‹
1. ã“ã®ç”»é¢ã§æ‰‹å…¥åŠ›ã€ãªã„ã—ã‚³ãƒ”ãƒšã¨ã„ã†ã®ãŒã€é–‹ç™ºã‚¹ã‚¿ã‚¤ãƒ«ã«ãªã‚‹

è¤‡æ•°ã‚¢ãƒ—ãƒªã‚’åŒæ™‚ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ã‚‚è€ƒãˆã¦ãŠããŸã„ã€‚è¤‡æ•°ã® Sheet ã‚’ä½¿ã£ãŸæ™‚ã«ã€ã‚³ãƒ¼ãƒ‰å…¨ä½“ã‚’ãã‚Œãã‚Œã«é…ç½®ã—ãŸã‚‰ã€ã‚³ãƒ¼ãƒ‰ã®ç¶­æŒç®¡ç†ãŒé¢å€’ã€‚å…±é€šéƒ¨åˆ†ã‚’ library ã«ã—ã¦ã€ Sheet ã”ã¨ã«é•ã†éƒ¨åˆ†ï¼ˆã‚¢ãƒ—ãƒªåã¨ã‹ï¼‰ã‚’ Sheet ã«ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ã§æ‰±ã†ã‚ˆã†ã«ã™ã‚‹ã€‚ library ç”¨ã®ã‚³ãƒ¼ãƒ‰ã¯ç‰¹å®šã® Sheet ã«é€£æºã•ã›ãªã„ã®ã§ã€ Apps Script Home ã‹ã‚‰å˜ç‹¬ã§æ–°è¦ä½œæˆã™ã‚‹ã€‚

## library

library ç”¨ã‚³ãƒ¼ãƒ‰ã® Apps Script ç”»é¢ã§ã€å·¦å´ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­¯è»Šï¼ˆâš™ Project Settingsï¼‰ã‚’é–‹ãã¨ã€ Script ID ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚ãã‚ŒãŒã€ library ã¨ã—ã¦å¤–éƒ¨ã‹ã‚‰å‚ç…§ã™ã‚‹ã¨ãã® ID ã«ãªã‚‹ã®ã§ã€ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚
å‚ç…§ã™ã‚‹å´ã® Apps Script ã® Editor ç”»é¢ã§ã€å·¦å´ã® libraries ã® + ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å…ˆç¨‹ã‚³ãƒ”ãƒ¼ã—ãŸ Script ID ã‚’è¿½åŠ ã™ã‚‹ã€‚ãã®ã¨ãã« Identifier ã¨ã—ã¦æŒ‡å®šã—ãŸåå‰ã§ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹ã€‚

Version ãŒé¸ã¹ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ Head ã«ãªã£ã¦ã„ã‚‹ã€‚ library å´ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿæ–½ã—ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½œã£ã¦ãŠãã¨ã€å½“è©²ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸ã¶ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤ã§å®‰å®šç‰ˆã‚’ä½œã£ã¦ãŠãã€é€šå¸¸ã®å‚ç…§ã¯ãã¡ã‚‰ã«ã™ã‚‹ã®ã“ã¨ã‚’ãŠè–¦ã‚ã™ã‚‹ã€‚ç·Šæ€¥æ™‚ã« library ã‚’ä¸€æ™‚å¤‰æ›´ã—ã€ãã‚Œã‚’ä½¿ã„ãŸã„ Sheet ã ã‘ Head å‚ç…§ã«ã™ã‚‹ã€ã¿ãŸã„ãªæ©Ÿå‹•çš„ãªå¯¾å¿œãŒã§ãã‚‹ã€‚

## Document Property

Sheet ã”ã¨ã®å›ºæœ‰æƒ…å ±ã‚’ã€ Document Property ã«ä¿å­˜ã™ã‚‹ã€‚

ä¿å­˜å…ˆã¯ã€å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãªã‚‹ã®ã§ã€ä»Šå›ã®ã ã¨ library ã«ãªã‚‹ã€‚ Document Property ã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã‚¢ãƒ—ãƒªã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã€ä»Šã®å ´åˆã ã¨ Sheet ã”ã¨ã«åŒºåˆ¥ã—ã¦ä¿æŒã•ã‚Œã‚‹ã®ã§ã€ Sheet ã”ã¨ã«ç•°ãªã‚‹è¨­å®šå€¤ã‚’æŒã¤ã“ã¨ãŒã§ãã‚‹ã€‚

ãŸã ã—ã€å˜ã«ã‚³ãƒ¼ãƒ‰ä¸Šã§å€¤ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ãªãã€å¤‰æ›´ã—ãŸå€¤ã‚’æ›¸ãè¾¼ã‚€ã¨ã„ã†æ“ä½œãŒå¿…è¦ã€‚

- [Property Service](https://developers.google.com/apps-script/reference/properties)

## ãƒˆãƒªã‚¬ãƒ¼

æ®‹å¿µãªã“ã¨ã«ã€ Google Groups ã¯ãƒˆãƒªã‚¬ãƒ¼ã‚’æŒã£ã¦ã„ãªã„ã€‚

ã‚‚ã—æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼ç™»éŒ²ã§ç™ºç«ã™ã‚‹ã‚ˆã†ãªãƒˆãƒªã‚¬ãƒ¼ãŒåˆ©ç”¨å¯èƒ½ãªã‚‰ã€è©±ã¯ã‚‚ã£ã¨å˜ç´”ã§çœã‚¨ãƒãƒ«ã‚®ãƒ¼ã§å‹•ãã®ã ã€‚ã ãŒç„¡ã„ã‚‚ã®ã¯è¿½ã„æ±‚ã‚ãšã€ç´ ç›´ã«ã‚¿ã‚¤ãƒãƒ¼ã§ãƒãƒ¼ãƒªãƒ³ã‚°ç›£è¦–ã‚’ã™ã‚‹ã€‚

Sheet ã”ã¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ Apps Script ç”»é¢ã‚’é–‹ãã€å·¦å´ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ™‚è¨ˆï¼ˆâ± Triggersï¼‰ã‚’é–‹ãã¨ã€èµ·å‹•æ–¹æ³•ã‚’é¸æŠã§ãã‚‹ã€‚æ¬¡ã®ã‚‚ã®ã‚’æŒ‡å®šã—ã¦ã€æ™‚è¨ˆã«ã‚ˆã‚‹èµ·å‹•ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€‚

- èµ·å‹•ã™ã‚‹é–¢æ•°å (executePromoCodeSender)
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (Head ã‚ã‚‹ã„ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³)
- ã‚¤ãƒ™ãƒ³ãƒˆ (spreadsheet ã«ãªã£ã¦ã„ã‚‹ã®ã‚’ Time-driven ã«ã™ã‚‹)
- ãƒˆãƒªã‚¬ãƒ¼ (minutes timer ã«ã™ã‚‹)
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ« (15 minutes ã«ã™ã‚‹)
- ã‚¨ãƒ©ãƒ¼é€šçŸ¥ (ãŠå¥½ã¿ã§ã€‚ç§ã¯ hourly ã«ã—ã¦ã„ã‚‹)

## Quota ã®æ³¢ã«ç¿»å¼„ã•ã‚Œã‚‹

æœ¬ç¨¼åƒã—ã¦ã¿ãŸã‚‰ã€ã•ã£ããã‚¨ãƒ©ãƒ¼ãŒé£›ã‚“ã§ããŸã€‚

> Exception: Service invoked too many times for one day: groups read.

ã©ã†ã‚„ã‚‰ã€ Group ã®ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã¨ã“ã‚ã§ä¸Šè¨˜ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚ˆã†ã ã€‚

- [Quotas for Google Services](https://developers.google.com/apps-script/guides/services/quotas)

> Groups read  2,000/day

2,000å›ã‚‚ã¾ã å‹•ã‹ã—ã¦ãªã„ãã€ã¨æ€ã£ãŸãŒã€ã¡ã‚‡ã†ã©å‰æ—¥ã«é–‹ç™ºã—ã¦ã„ãŸã¨ãã€ãƒ‡ãƒãƒƒã‚°ã§ç¹°ã‚Šè¿”ã—èµ°ã‚‰ã›ã¦ã„ãŸã“ã¨ã«æ°—ã¥ã„ãŸã€‚ã©ã†ã‚„ã‚‰é–‹ç™ºä¸­ã« API ã‚’ä½¿ã„ã™ããªã„ã‚ˆã†ãªå·¥å¤«ãŒå¿…è¦ã ã¨ã‚ã‹ã£ãŸã€‚

ã§ã€ã“ã® quota ã ãŒã€1æ—¥ã®åŒºåˆ‡ã‚Šã¨ã„ã†ã‚‚ã®ã¯ãªãã€ç›´è¿‘ã® 24æ™‚é–“ã«ä½¿ã£ãŸå›æ•°ã§åˆ¶é™ãŒã‹ã‹ã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚å‰æ—¥ã«ç¹°ã‚Šè¿”ã—èµ·å‹•ã‚’ã‹ã‘ã¦ã„ãŸæ™‚é–“å¸¯ã‚’éãã‚‹ã¨ã€å†ã³ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

## Promo code è£œå……

codes ã‚·ãƒ¼ãƒˆã® Cåˆ—ã«ã€é€ä¿¡æ¸ˆã¿ãƒ•ãƒ©ã‚°ã¨ã—ã¦ 1 ã‚’ç«‹ã¦ã¦ã„ã‚‹ã€‚ Promo code ãŒè¶³ã‚Šãªããªã‚‹ã¨é€ä¿¡ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã‚‹ãŒã€ã‚¨ãƒ©ãƒ¼åˆ†ã¯ãƒ•ãƒ©ã‚°ãŒ 0 ãªã®ã§ã€æœªé€ä¿¡ã ã¨åˆ¤å®šã§ãã‚‹ã€‚ Aåˆ—ã«è¿½åŠ ã® Promo code ã‚’ã‚³ãƒ”ãƒšã—ã¦è£œå……ã—ã¦ã‚„ã‚‹ã ã‘ã§ã€æ¬¡å›ã®èµ·å‹•æ™‚ã«ã‚¨ãƒ©ãƒ¼æœªé€ä¿¡ã®ã‚‚å«ã‚ã¦ã€ Promo code ã‚’é€ä¿¡ã—ã¦ãã‚Œã‚‹ã€‚

## ã‚³ãƒ¼ãƒ‰

- [tiny_tools/promo_code_sender_gas](https://github.com/nyosak/tiny_tools/tree/main/promo_code_sender_gas)
- [PromoCodeSender (for library)](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/PromoCodeSender.gs)
- [Executor (for sheet)](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/Executor.gs)
- [Library Documentation](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/LibraryDocumentation.html)

## ä½¿ã„æ–¹


### 1. library PromoCodeSender ã‚’ä½œæˆ

- Apps Script Home ã‚’é–‹ã
- æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
- PromoCodeSender ãªã©ã¨åä»˜ã‘ã‚‹
- GitHub ã® [PromoCodeSender.gs](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/PromoCodeSender.gs) ã‚’è²¼ã‚Šä»˜ã‘ã‚‹
- æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œ

### 2. å®Ÿè¡Œç”¨ Sheet ã¨ã—ã¦ Executor ã‚’ä½œæˆ

- My Drive ã‚’é–‹ã
- æ–°è¦ Sheet ã‚’ä½œæˆ
- Executor ãªã©ã¨åä»˜ã‘ã‚‹
- ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ ã—ã¦ 2ã¤ã«ã—ã€ codes, emails ã¨åä»˜ã‘ã‚‹
- codes ã‚·ãƒ¼ãƒˆã® 1è¡Œç›® A,B,C,D ã«ã€Promotion code,Email,Sent,Timestamp ã¨å…¥åŠ›ã—ã¦ãŠã
- Promotion code ã®ä¸‹ã€A2 ã‹ã‚‰ä¸‹ã«ã€ç”¨æ„ã—ãŸ Promo code ã‚’è²¼ã‚Šä»˜ã‘ã¦ãŠã
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® Extensions -> Apps Script ã§ã€ç´ä»˜ã„ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–°ã—ãé–‹ã
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚ã€ Executor ãªã©ã¨åå‰ã‚’ã¤ã‘ã¦ãŠãï¼ˆåå‰ã¯é€£å‹•ã—ãªã„ï¼‰
- GitHub ã® [Executor.gs](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/Executor.gs) ã‚’è²¼ã‚Šä»˜ã‘ã‚‹
- library ã®å‚ç…§ã®è¿½åŠ ã‚’é¸ã³ã€ PromoCodeSender ã® Script ID ã‚’å…¥ã‚Œã¦ã€ PromoCodeSender ã®åç§°ã§å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

### 3. ä½¿ç”¨ã™ã‚‹ Google Group åãªã©ã‚’ç™»éŒ²

- Executor ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ãã€ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹
- setProperties å†…ã®å®šæ•°ã‚’å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã™ã‚‹
    - APP_NAME, GROUP_EMAIL ã¯å¿…ãšä¿®æ­£ã™ã‚‹
    - DISABLE_EMAIL, DISABLE_GROUPS_APP ãŒ true (debug mode) ãªã®ã§ null ã«ã™ã‚‹
- ä¿å­˜ã—ã¦ã€ setProperties ã‚’ Run ã§æ‰‹å‹•å®Ÿè¡Œ
- showProperties ã‚’ Run ã§æ‰‹å‹•å®Ÿè¡Œã—ã€è¨­å®šå†…å®¹ã‚’ç¢ºèªã™ã‚‹
- æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿè¡Œ

### 4. ãŠè©¦ã—

- æ–°è¦ Google Group ã‚’ä½œã£ãŸã®ã§ã‚ã‚Œã°ã€è‡ªåˆ†ã ã‘ãŒ owner ã¨ã—ã¦ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹
- æ‰‹å‹•å®Ÿè¡Œã™ã‚Œã°ã€è‡ªåˆ†ã« Promo code ãƒ¡ãƒ¼ãƒ«ãŒé£›ã‚“ã§ãã‚‹ã¯ãš
- Executor ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã
- executePromoCodeSender ã‚’ Run ã§æ‰‹å‹•å®Ÿè¡Œ
- ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ­ã‚°ã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹
- ãƒ¡ãƒ¼ãƒ«ãŒé£›ã‚“ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹

### 5. ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®šã—ã¦æœ¬ç¨¼åƒ

- Executor ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã
- ãƒˆãƒªã‚¬ãƒ¼ã‚’æ–°ã—ãè¿½åŠ ã™ã‚‹
- executePromoCodeSender ãŒä¸€å®šæ™‚é–“ã”ã¨ã«èµ·å‹•ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹
- å·¦å´ãƒŠãƒ“ã® â‰¡ Executions ã§ã€æ‰€å®šã®æ™‚é–“ã«èµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã¨ã€ãã®å®Ÿè¡Œãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹

# ğŸŒ–ï¸ æ€¥

## å‚è€ƒè³‡æ–™

### ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£

- [Androidã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ†ã‚¹ãƒˆã‚’æœ€é€Ÿã§ä¹—ã‚Šè¶Šãˆã‚‹æ–¹æ³•](https://zenn.dev/android_tester/articles/f12a1e313fd216)
- [Androidã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ†ã‚¹ãƒˆã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®ã”æ”¯æ´ã®ãŠé¡˜ã„](https://note.com/yusuke1225math2/n/n5eb506280c20)
- [r/AndroidClosedTesting - reddit](https://www.reddit.com/r/AndroidClosedTesting/)
- [ã€å‚™å¿˜éŒ²ã€‘GASã§ã®throwã§å¿…ãšã‚„ã£ã¦ãŠã„ãŸã»ã†è‰¯ã„ã¨ã¦ã‚‚é‡è¦ãªãŠè©±](https://qiita.com/Cheap-Engineer/items/da7fc8c54810fe661bde)

### Google

- [Apps Script](https://script.google.com/home)
- [Gmail](https://developers.google.com/apps-script/reference/gmail/gmail-app)
- [Group](https://developers.google.com/apps-script/reference/groups/group)
- [Sheet](https://developers.google.com/apps-script/reference/spreadsheet/range)
- [running account](https://developers.google.com/apps-script/reference/base/user.html)
- [Property Service](https://developers.google.com/apps-script/reference/properties)
- [Quotas for Google Services](https://developers.google.com/apps-script/guides/services/quotas)
- [Create and manage deployments](https://developers.google.com/apps-script/concepts/deployments)
- [Google JavaScript Style Guide](https://google.github.io/styleguide/jsguide.html)
- [ã‚®ãƒ•ãƒˆã‚«ãƒ¼ãƒ‰ã¾ãŸã¯ã‚®ãƒ•ãƒˆã‚³ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ - Google Play ãƒ˜ãƒ«ãƒ—](https://support.google.com/googleplay/answer/3422659?hl=ja)

### ãƒ¬ãƒã‚¸ãƒˆãƒª

- [tiny_tools/promo_code_sender_gas](https://github.com/nyosak/tiny_tools/tree/main/promo_code_sender_gas)
- [PromoCodeSender (for library)](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/PromoCodeSender.gs)
- [Executor (for sheet)](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/Executor.gs)
- [Library Documentation](https://github.com/nyosak/tiny_tools/blob/main/promo_code_sender_gas/LibraryDocumentation.html)
