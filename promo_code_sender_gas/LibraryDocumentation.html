<html><head><title>Library Documentation</title><link rel="stylesheet" type="text/css" href="//developers.google.com/_static/css/screen-docs.css" nonce="cvsvus6L1uOPRF3MSaTo0g"/><link href='//fonts.googleapis.com/css?family=Open+Sans:300,400' rel='stylesheet' type='text/css' nonce="cvsvus6L1uOPRF3MSaTo0g"></head><body class="two-column docs"><div id="gc-wrapper"><div id="gc-main" class="main"><div id="gc-content" style="margin-left:0"><h1 class="page_title">PromoCodeSender (version 4)</h1><p>sends promo code to google group member email<h2>generateMailBody(string code, date now, string deep_link_code, string google_play_help)</h2><p>generate a mail body<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>code</td><td><code>string</code></td><td>Promo code</td></tr><tr><td>now</td><td><code>date</code></td><td>Date time of issuing</td></tr><tr><td>deep_link_code</td><td><code>string</code></td><td>Deep link to redeem the code</td></tr><tr><td>google_play_help</td><td><code>string</code></td><td>URL of help to redeem the code</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>string</code></td><td>Mail body</td></tr></tbody></table><h2>getGroupMembers(string group_email, Object emails_sheet)</h2><p>returns current member emails of Google groups by group email<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>group_email</td><td><code>string</code></td><td>Email address of target Google Group</td></tr><tr><td>emails_sheet</td><td><code>Object</code></td><td></td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>!Array</code></td><td>Array of all users that registered to the group</td></tr></tbody></table><h2>getGroupMembersByApi(string group_email)</h2><p>returns current member emails of Google groups by group email
quota reading: 2,000 / day<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>group_email</td><td><code>string</code></td><td>Email address of target Google Group</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>!User[]</code></td><td>Array of all users that registered to the group</td></tr></tbody></table><h2>updateCodesSheet(!Sheet sheet, !Array users)</h2><p>add new members into sheet<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet</td><td><code>!Sheet</code></td><td>Sheet for codes</td></tr><tr><td>users</td><td><code>!Array</code></td><td>Email list of current users</td></tr></tbody></table><h2>doPromoCodeSender()</h2><p>main (expects to be called by executePromoCodeSender in Executor.gs)<h2>sendCode(!Sheet sheet)</h2><p>send promo code to new-comers<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet</td><td><code>!Sheet</code></td><td>Sheet for codes</td></tr></tbody></table><h2>sendEmail(string email, string subject, string body, !Object options)</h2><p>send email wrapper<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>email</td><td><code>string</code></td><td>Recipient email address</td></tr><tr><td>subject</td><td><code>string</code></td><td>Mail subject</td></tr><tr><td>body</td><td><code>string</code></td><td>Mail body</td></tr><tr><td>options</td><td><code>!Object</code></td><td>Options associated array (optional)</td></tr></tbody></table><h2>showProperties()</h2><p>show config<h2>getSheet(string sheet_name)</h2><p>get sheet by name<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet_name</td><td><code>string</code></td><td>Sheet name</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>!Sheet</code></td><td>Sheet of specified name</td></tr></tbody></table><h2>sendToAdmin(string subject, string body)</h2><p>send message to admin (account executing)<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>subject</td><td><code>string</code></td><td>Mail subject</td></tr><tr><td>body</td><td><code>string</code></td><td>Mail body</td></tr></tbody></table><h2>showDocProperties()</h2><p>show document property list to log<h2>getGroupMembersFromSheet(!Sheet sheet)</h2><p>returns current member emails from sheet itself
only for urgent. e.g. loosing quota.<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet</td><td><code>!Sheet</code></td><td>Sheet for emails (means it will not be updated)</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>string[]</code></td><td>Array of all users on the emails sheet</td></tr></tbody></table><h2>getDocProperties()</h2><p>get document properties<h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>!Object</code></td><td>Document properties as associated array</td></tr></tbody></table><h2>sendPromoCode(string email, string code, date now)</h2><p>send promo code with bcc admin<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>email</td><td><code>string</code></td><td>Recipient email address</td></tr><tr><td>code</td><td><code>string</code></td><td>Promo code</td></tr><tr><td>now</td><td><code>date</code></td><td>Date time of issuing</td></tr></tbody></table><h2>setDocProperties(!Object properties)</h2><p>set document properties<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>properties</td><td><code>!Object</code></td><td>Document properties to set as associated array</td></tr></tbody></table><h2>getExecutorEmail()</h2><p>email address of script executor<h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>string</code></td><td>Email address of active google account</td></tr></tbody></table><h2>getDocP(Object key)</h2><p>get document property<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>key</td><td><code>Object</code></td><td></td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>string</code></td><td>Document property ies as associated array</td></tr></tbody></table><h2>deepLinkPromoCode(string code)</h2><p>get deep link for promo code<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>code</td><td><code>string</code></td><td>Promo code</td></tr></tbody></table><h3>Return Values:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="width: 20%;">Type</th><th scope="col" style="width: 80%;">Description</th></tr><tr><td><code>string</code></td><td>Google Play deep link to redeem the promo code</td></tr></tbody></table><h2>updateEmailsSheet(!Sheet sheet, !Array users)</h2><p>replace email list at sheet<h3>Arguments:</h3><table style="width: 100%"><tbody><tr><th scope="col" style="wdith: 20%;">Name</th><th scope="col" style="width: 15%;">Type</th><th scope="col" style="width: 65%;">Description</th></tr><tr><td>sheet</td><td><code>!Sheet</code></td><td>Sheet for emails</td></tr><tr><td>users</td><td><code>!Array</code></td><td>Email list of current users</td></tr></tbody></table><h2>executePromoCodeSender()</h2><p>main executor<h2>setProperties()</h2><p>set config
modify and run this before using</div></div></div></body></html>